<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cuan - Bongkar Coin</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="mobile-container">
        <header class="header">
            <div class="logo-section">
                <img src="https://via.placeholder.com/100" alt="Logo Cuan" class="logo">
                <h1>BELINYA UNTUNG<br>BONGKARNYA CEPAT!</h1>
            </div>
            <button class="btn-download">â¬‡ Download APK</button>
        </header>

        <div class="card-form">
            <div class="card-header">Masukkan Data Anda</div>
            <div class="form-group">
                <label>Neo ID</label>
                <input type="number" id="player_id_input" placeholder="Masukkan ID (e.g. 168954314)">
            </div>
            <div class="form-group">
                <label>No. Whatsapp</label>
                <input type="tel" id="whatsapp_input" placeholder="No. Whatsapp">
            </div>
        </div>

        <div class="tabs-wrapper">
            <div class="tab-item">TOP UP</div>
            <div class="tab-item active">BONGKAR</div>
        </div>

        <div class="price-grid">
            <div class="price-item hot" onclick="handleBongkar('1B', '60.000')">
                <div class="badge-hot">Hot</div>
                <span class="amount">1B</span>
                <span class="price">60.000</span>
            </div>
            <div class="price-item" onclick="handleBongkar('200M', '12.000')">
                <span class="amount">200M</span>
                <span class="price">12.000</span>
            </div>
            <div class="price-item" onclick="handleBongkar('300M', '18.000')">
                <span class="amount">300M</span>
                <span class="price">18.000</span>
            </div>
            <div class="price-item" onclick="handleBongkar('400M', '24.000')">
                <span class="amount">400M</span>
                <span class="price">24.000</span>
            </div>
            <div class="price-item" onclick="handleBongkar('500M', '30.000')">
                <span class="amount">500M</span>
                <span class="price">30.000</span>
            </div>
            <div class="price-item" onclick="handleBongkar('600M', '36.000')">
                <span class="amount">600M</span>
                <span class="price">36.000</span>
            </div>
        </div>
    </div>

    <div id="orderModal" class="modal">
        <div class="modal-content">
            <div class="modal-banner">DETAIL PESANAN</div>
            <div class="modal-body">
                <div class="detail-item">
                    <span>ID Pemain</span>
                    <strong id="res-id">-</strong>
                </div>
                <div class="detail-item">
                    <span>Nickname</span>
                    <strong id="res-nickname" class="text-gold">Mengecek...</strong>
                </div>
                <div class="detail-item">
                    <span>Pesanan</span>
                    <strong id="res-product">-</strong>
                </div>
                <div class="detail-item">
                    <span>Total Harga</span>
                    <strong id="res-price">-</strong>
                </div>
            </div>
            <div class="modal-footer">
                <button id="btn-final" class="btn-confirm-final" onclick="kirimKeAdmin()">KONFIRMASI</button>
                <button class="btn-close" onclick="closeModal()">BATAL</button>
            </div>
        </div>
    </div>

    <script>
        async function handleBongkar(nominal, harga) {
            const id = document.getElementById('player_id_input').value;
            const wa = document.getElementById('whatsapp_input').value;

            if (!id || !wa) {
                alert("Harap isi ID dan Nomor WhatsApp terlebih dahulu!");
                return;
            }

            // Tampilkan Modal
            const modal = document.getElementById('orderModal');
            modal.style.display = 'flex';
            
            // Set Data Tampilan Modal
            document.getElementById('res-id').innerText = id;
            document.getElementById('res-product').innerText = "Bongkar " + nominal;
            document.getElementById('res-price').innerText = "Rp " + harga;
            
            const nickSpan = document.getElementById('res-nickname');
            const btnFinal = document.getElementById('btn-final');
            
            nickSpan.innerText = "Mengecek...";
            nickSpan.style.color = "#d35400";
            btnFinal.disabled = true;
            btnFinal.style.opacity = "0.5";

            try {
                // Fetch ke backend api/cek.js
                const response = await fetch('/api/cek', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ player_id: id })
                });

                const res = await response.json();

                // Logika pengecekan sesuai API Anda
                if (res.En === 0 && res.Data) {
                    nickSpan.innerText = res.Data.player_nick;
                    nickSpan.style.color = "#27ae60";
                    btnFinal.disabled = false;
                    btnFinal.style.opacity = "1";
                } else {
                    nickSpan.innerText = "ID Tidak Ditemukan";
                    nickSpan.style.color = "red";
                }
            } catch (e) {
                nickSpan.innerText = "Error Server";
                nickSpan.style.color = "red";
            }
        }

        function closeModal() {
            document.getElementById('orderModal').style.display = 'none';
        }

        function kirimKeAdmin() {
            const id = document.getElementById('res-id').innerText;
            const nick = document.getElementById('res-nickname').innerText;
            const pesanan = document.getElementById('res-product').innerText;
            
            // Contoh format pesan WhatsApp
            const pesan = `Halo Admin, saya mau bongkar:\nID: ${id}\nNick: ${nick}\nProduk: ${pesanan}`;
            const linkWA = `https://wa.me/628123456789?text=${encodeURIComponent(pesan)}`;
            
            window.open(linkWA, '_blank');
        }
    </script>
</body>
</html>
